{"version":3,"sources":["../../scripts/main.ts","../../scripts/blocks.ts"],"sourcesContent":["import { world, system } from \"@minecraft/server\";\n\nimport { control_door, small_door_below, small_door_upper } from \"./blocks\";\n\nsystem.beforeEvents.startup.subscribe((t) => {\n  t.blockComponentRegistry.registerCustomComponent(\"scp:control_door\", control_door);\n});\n\nsystem.beforeEvents.startup.subscribe((t) => {\n  t.blockComponentRegistry.registerCustomComponent(\"scp:small_door_below\", small_door_below);\n});\n\nsystem.beforeEvents.startup.subscribe((t) => {\n  t.blockComponentRegistry.registerCustomComponent(\"scp:small_door_upper\", small_door_upper);\n});\n","import {\r\n  BlockComponentOnPlaceEvent,\r\n  BlockComponentPlayerInteractEvent,\r\n  CustomComponentParameters,\r\n  system,\r\n  world,\r\n} from \"@minecraft/server\";\r\n\r\nexport const control_door = {\r\n  onPlayerInteract(arg0: BlockComponentPlayerInteractEvent, arg1: CustomComponentParameters) {\r\n    const block = arg0.block;\r\n\r\n    // @ts-ignore\r\n    const control = arg1.params.control;\r\n    const state = block.permutation.getState(control);\r\n\r\n    if (state == 0) {\r\n      block.setPermutation(block.permutation.withState(control, 1));\r\n\r\n      for (let index = 2; index <= 10; index++) {\r\n        system.runTimeout(\r\n          () => {\r\n            block.setPermutation(block.permutation.withState(control, index));\r\n          },\r\n          3 * (index - 1)\r\n        );\r\n      }\r\n    }\r\n\r\n    if (state == 10) {\r\n      block.setPermutation(block.permutation.withState(control, 9));\r\n\r\n      let a = 0;\r\n      for (let index = 8; index >= 0; index--) {\r\n        a += 1;\r\n        system.runTimeout(() => {\r\n          block.setPermutation(block.permutation.withState(control, index));\r\n        }, 3 * a);\r\n      }\r\n    }\r\n  },\r\n};\r\n\r\nexport const small_door_below = {\r\n  onPlace(arg0: BlockComponentOnPlaceEvent, arg1: CustomComponentParameters) {\r\n    const dimension = world.getDimension(\"overworld\");\r\n    const block = arg0.block;\r\n    const x = block.location.x;\r\n    const y = block.location.y;\r\n    const z = block.location.z;\r\n\r\n    // @ts-ignore\r\n    const direction = arg1.params.direction;\r\n    const face = block.permutation.getState(direction);\r\n\r\n    dimension.runCommand(\r\n      \"setblock \" +\r\n        x +\r\n        \" \" +\r\n        (y + 1) +\r\n        \" \" +\r\n        z +\r\n        ' scp:small_door_upper[\"door:open\"=\"false\",\"minecraft:cardinal_direction\"=\"' +\r\n        face +\r\n        '\"]'\r\n    );\r\n  },\r\n\r\n  onPlayerInteract(arg0: BlockComponentPlayerInteractEvent, arg1: CustomComponentParameters) {\r\n    const block = arg0.block;\r\n\r\n    // @ts-ignore\r\n    const control = arg1.params.control;\r\n    // @ts-ignore\r\n    const direction = arg1.params.direction;\r\n    const face = block.permutation.getState(direction);\r\n    let state = block.permutation.getState(control);\r\n\r\n    const x = block.location.x;\r\n    const y = block.location.y;\r\n    const z = block.location.z;\r\n\r\n    const location = block.location;\r\n    location.x += 0.5;\r\n    location.z += 0.5;\r\n\r\n    const dimension = world.getDimension(\"overworld\");\r\n\r\n    if (face == \"north\" || face == \"south\") {\r\n      block.setPermutation(block.permutation.withState(control, \"null\"));\r\n\r\n      // @ts-ignore\r\n      const entity = dimension.spawnEntity(\"scp:small_door_entity_north\", location);\r\n      if (state == \"false\") {\r\n        dimension.playSound(\"scp.small_door_open\", location);\r\n        entity.setProperty(\"door:open\", false);\r\n        state = \"true\";\r\n      } else {\r\n        dimension.playSound(\"scp.small_door_close\", location);\r\n        entity.setProperty(\"door:open\", true);\r\n        state = \"false\";\r\n      }\r\n\r\n      system.runTimeout(() => {\r\n        entity.remove();\r\n        block.setPermutation(block.permutation.withState(control, state));\r\n      }, 29);\r\n    } else {\r\n      block.setPermutation(block.permutation.withState(control, \"null\"));\r\n\r\n      // @ts-ignore\r\n      const entity = dimension.spawnEntity(\"scp:small_door_entity_west\", location);\r\n      if (state == \"false\") {\r\n        dimension.playSound(\"scp.small_door_open\", location);\r\n        entity.setProperty(\"door:open\", false);\r\n        state = \"true\";\r\n      } else {\r\n        dimension.playSound(\"scp.small_door_close\", location);\r\n        entity.setProperty(\"door:open\", true);\r\n        state = \"false\";\r\n      }\r\n\r\n      system.runTimeout(() => {\r\n        entity.remove();\r\n        block.setPermutation(block.permutation.withState(control, state));\r\n      }, 29);\r\n    }\r\n  },\r\n};\r\n\r\nexport const small_door_upper = {\r\n  onPlayerInteract(arg0: BlockComponentPlayerInteractEvent, arg1: CustomComponentParameters) {},\r\n};\r\n"],"mappings":"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","names":["system","system"],"file":"../scripts/main.js"}